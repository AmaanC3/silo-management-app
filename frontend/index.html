<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Silo Management</title>
    <style>
        /* Basic styling for silo containers */
        #silo-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
        }

        .silo {
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px;
            width: 200px;
            text-align: center;
        }

        /* Styling for silo info text */
        h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        p {
            font-size: 14px;
            margin: 5px 0;
        }

        /* Text color for warnings on current level */
        .current-level-low {
            color: green; /* Normal if less than 60% */
        }

        .current-level-medium {
            color: orange; /* Near capacity if between 60% and 90% */
        }

        .current-level-high {
            color: red; /* Over capacity if more than 90% */
        }

        /* Styling for temperature and humidity */
        .temperature-warning {
            color: red; /* Red for high temperature */
        }

        .humidity-low {
            color: blue; /* Blue for low humidity */
        }

        .humidity-medium {
            color: green; /* Yellow for moderate humidity */
        }

        .humidity-high {
            color: purple; /* Purple for high humidity */
        }
    </style>
</head>

<body>

    <h1>Silo Management System</h1>

    <!-- File input for uploading CSV -->
    <input type="file" id="csvFileInput" accept=".csv">
    <div id="silo-container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <script>
        // Function to handle file upload and parse CSV
        document.getElementById('csvFileInput').addEventListener('change', function (event) {
            const file = event.target.files[0];

            if (file) {
                // Parse the CSV file
                Papa.parse(file, {
                    complete: function (result) {
                        console.log(result.data); // Log the parsed CSV data
                        renderSilos(result.data);
                    },
                    header: true, // Assuming the first row contains column names
                    skipEmptyLines: true
                });
            }
        });

        // Function to render silo data
        function renderSilos(data) {
            const siloContainer = document.getElementById('silo-container');
            siloContainer.innerHTML = ''; // Clear any existing content

            // Loop through each silo in the data and display its information
            data.forEach(silo => {
                const siloElement = document.createElement('div');
                siloElement.classList.add('silo');

                // Determine the text color for the current level based on its value
                let currentLevelClass = 'current-level-low'; // Default to low
                const currentLevel = parseFloat(silo['Current Level']);
                const capacity = parseFloat(silo['Capacity']);
                if (currentLevel >= capacity * 0.9) {
                    currentLevelClass = 'current-level-high'; // Over 90% capacity
                } else if (currentLevel >= capacity * 0.6) {
                    currentLevelClass = 'current-level-medium'; // Between 60% and 90% capacity
                }

                // Determine the text color for temperature
                const temperatureClass = parseFloat(silo['Temperature']) > 30 ? 'temperature-warning' : ''; // High temperature

                // Determine the text color for humidity
                let humidityClass = '';
                const humidity = parseFloat(silo['Humidity']);
                if (humidity < 40) {
                    humidityClass = 'humidity-low'; // Low humidity
                } else if (humidity > 60) {
                    humidityClass = 'humidity-high'; // High humidity
                } else {
                    humidityClass = 'humidity-medium'; // Moderate humidity
                }

                // Insert silo data into the HTML
                siloElement.innerHTML = `
                    <h3>${silo['Silo Name']}</h3>
                    <p>Capacity: ${capacity}</p>
                    <p class="${currentLevelClass}">Current Level: ${currentLevel}</p>
                    <p class="${temperatureClass}">Temperature: ${silo['Temperature']}Â°C</p>
                    <p class="${humidityClass}">Humidity: ${humidity}%</p>
                `;

                siloContainer.appendChild(siloElement);
            });
        }
    </script>

</body>

</html>
